Right. This is the moment we lock this down properly and stop bleeding time on clever-but-brittle detection.

Below is a full, comprehensive Replit promotion / instruction you can drop straight into replit.md or paste as the top-level brief for Ratplet. It is written to be unambiguous, grounded in real evidence, and decisive. No wiggle room. No ‚Äúmaybe‚Äù.

I‚Äôve structured it so Replit understands:
	‚Ä¢	why this change is mandatory
	‚Ä¢	what must be built
	‚Ä¢	what must not break
	‚Ä¢	what success looks like

‚∏ª

üîí Canonical Instruction: Orbit Extraction Intent Selection (Mandatory)

Context (Read First ‚Äì Do Not Skip)

The current Orbit auto-detection system is architecturally unreliable for a large class of real websites, particularly B2B and service-led sites.

This has been proven through live testing and production logs.

Real failure evidence (ground truth)

Site: https://www.tugo.co.uk
Type: B2B food service company
Platform: WordPress (correctly fingerprinted)

Observed behaviour (Jan 1, 2026):
	‚Ä¢	Auto-detection returned none (confidence ~38%)
	‚Ä¢	Fingerprinting correctly identified WordPress
	‚Ä¢	Extraction pipeline then searched for menu / catalogue patterns
	‚Ä¢	Zero candidates found
	‚Ä¢	API returned 400 ‚Äì Could not extract any products or menu items

This is not a threshold issue.
This is not a tuning issue.
This is a category error.

B2B service sites do not emit the structural signals (prices, products, menus) that the detection heuristics rely on.

Threshold tuning, CMS fingerprinting, and fallback logic have all been attempted and do not solve the core problem.

‚∏ª

Strategic Decision (Canonical)

We are replacing detection-first extraction with intent-first extraction, while keeping auto-detect as an optional convenience.

Orbit must ask users what information on their site is most valuable to visitors, and use that answer to select the extraction strategy.

This is now a foundational product decision, not an experiment.

‚∏ª

Required UX Change (Frontend)

Add an Intent Selection Step to Orbit Claim / Generate Flow

Primary question (exact wording)
‚ÄúWhat information on your site would be most valuable to visitors?‚Äù

Supporting microcopy
Orbit will focus on understanding and structuring this information first.

Options (exact intent labels)
	‚Ä¢	Menu & pricing
What you sell, organised into clear sections
	‚Ä¢	Products & shop items
Individual products, variations and details
	‚Ä¢	Services & capabilities
What you do, who it‚Äôs for, and how it helps
	‚Ä¢	Case studies & work
Examples, projects and results
	‚Ä¢	Articles & resources
Blogs, guides and helpful content
	‚Ä¢	Locations & contact details
Where you operate and how to get in touch
	‚Ä¢	Let Orbit decide (default)
We‚Äôll try to work it out automatically

UX rules
	‚Ä¢	Default selection: Let Orbit decide
	‚Ä¢	Selection must be clearly optional
	‚Ä¢	User must be able to rerun Orbit with a different selection later
	‚Ä¢	This is intent-setting, not a permanent lock

‚∏ª

Required API Change (Backend)

Extend /api/orbit/generate

Request body

{
  "sourceUrl": "https://example.com",
  "extractionIntent": "menu" 
}

Where extractionIntent can be:
	‚Ä¢	"menu"
	‚Ä¢	"catalogue"
	‚Ä¢	"service"
	‚Ä¢	"case_studies"
	‚Ä¢	"content"
	‚Ä¢	"locations"
	‚Ä¢	null (auto-detect)

Behaviour rules (non-negotiable)
	‚Ä¢	If extractionIntent is provided:
	‚Ä¢	Bypass all site-type detection and scoring
	‚Ä¢	Route directly to the matching extractor
	‚Ä¢	Do NOT apply confidence thresholds
	‚Ä¢	Do NOT fall back to menu/catalogue heuristics
	‚Ä¢	If extractionIntent is null:
	‚Ä¢	Use existing auto-detection logic (unchanged)

This ensures:
	‚Ä¢	Backward compatibility
	‚Ä¢	Zero regression for working restaurant flows
	‚Ä¢	Deterministic behaviour when the user knows their intent

‚∏ª

Extraction Architecture (Clarification)

Orbit must operate on extraction archetypes, not ‚Äúwebsite types‚Äù or ‚Äúindustries‚Äù.

Each extractor should assume:
	‚Ä¢	It was intentionally selected
	‚Ä¢	Absence of prices/products is NOT an error for service/content extractors
	‚Ä¢	Success is defined by producing structured, visitor-useful information

Example

For "service" extraction:
	‚Ä¢	Headings like ‚ÄúWhat we do‚Äù, ‚ÄúServices‚Äù, ‚ÄúSolutions‚Äù
	‚Ä¢	Capability descriptions
	‚Ä¢	Industries served
	‚Ä¢	Value propositions
	‚Ä¢	CTAs

A lack of prices or products must never trigger a failure.

‚∏ª

What Must Not Break (Critical)

The following must remain unchanged and working:
	‚Ä¢	Restaurant menu extraction (e.g. Red Lion Bloxham)
	‚Ä¢	Auto-detect default behaviour
	‚Ä¢	Existing tests for menu/catalogue extraction
	‚Ä¢	Public API contract for callers who do not supply intent

No regressions are acceptable here.

‚∏ª

Success Criteria (Definition of Done)

This change is considered successful when:
	1.	Tugo.co.uk
	‚Ä¢	Works on first run when ‚ÄúServices & capabilities‚Äù is selected
	‚Ä¢	Returns structured service information
	‚Ä¢	Does NOT return a 400 error
	2.	Known restaurant site
	‚Ä¢	Still extracts full menus via auto-detect
	‚Ä¢	No loss of items or categories
	3.	Developer clarity
	‚Ä¢	Logs clearly state whether extraction was:
	‚Ä¢	intent-driven, or
	‚Ä¢	auto-detected
	4.	UX clarity
	‚Ä¢	Users understand why they are being asked
	‚Ä¢	No jargon or technical language exposed

‚∏ª

Final Note (Why this is locked)

Auto-detection is a convenience feature.
It is not reliable enough to be a gatekeeper.

The user is the ultimate authority on what matters on their site.
Orbit must respect that intent.

This instruction is canonical and supersedes all previous detection-first approaches.

‚∏ª

If you want, next we can:
	‚Ä¢	Add multi-intent extraction (run services + case studies)
	‚Ä¢	Add recommended defaults based on weak detection signals
	‚Ä¢	Or formalise extractor interfaces so Claude and future agents can plug into them cleanly

But for now:
This fixes it once and for all.